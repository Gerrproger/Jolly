/*!
 * Jolly - modern responsive carousel with zooming
 * @version  v1.1.0
 * @author   Gerrproger
 * Website:  http://gerrproger.github.io/Jolly
 * Repo:     http://github.com/gerrproger/jolly
 * Issues:   http://github.com/gerrproger/jolly/issues
 */
!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=t(e,document):"function"==typeof define&&define.amd?define(null,function(){t(e,document)}):e.jolly=t(e,document)}("undefined"!=typeof window?window:this,function(e,t){"use strict";function o(){var e=arguments;if(e.length){if(1==e.length)return e[0];for(var t=Array.prototype.shift.call(e),r=e.length,l=0;r>l;l++){var s=e[l];for(var i in s)s[i]&&s[i].constructor&&s[i].constructor===Object?(t[i]=t[i]||{},o(t[i],s[i])):t[i]=s[i]}return t}}function r(e,t,o){return e.replace(new RegExp(t.replace(/([.*+?\^=!:${}()|\[\]\/\\])/g,"\\$1"),"g"),o)}function l(e,t,o){e.insertBefore(t,o)}function s(e,t){e.appendChild(t)}function i(e,t){for(var o in t)e.setAttribute(o,"boolean"==typeof t[o]&&t[o]?"":t[o])}function n(e,o,r){var l=t.createElement(e);return o&&i(l,o),r&&s(r,l),l}function c(e,t,o){if(e)if(e.classList)e.classList[o?"add":"remove"](t);else{var r=(" "+e.className+" ").replace(/\s+/g," ").replace(" "+t+" ","");e.className=r+(o?" "+t:"")}}function a(e,t,o,r){var l=t.split(" ");if(e instanceof NodeList)for(var s=0;s<e.length;s++)e[s]instanceof Node&&a(e[s],arguments[1],arguments[2]);else for(var i=0;i<l.length;i++)e[r?"addEventListener":"removeEventListener"](l[i],o,!1)}function f(){var e=n("p").style;return"transition"in e||"WebkitTransition"in e||"MozTransition"in e||"OTransition"in e}function m(e,t,o){function r(e){var t=null;e.target===L.scroller&&(c(L.scroller,d.selectors.scrollerTransition),"next"===_?(t=L.list[0],s(L.scroller,t.element),L.offset+=t.width,L.scroller.style[O]=L.offset+"px",L.active--,L.list.push(L.list.shift())):"prev"===_&&(t=L.list.slice(-1)[0],l(L.scroller,t.element,L.list[0].element),L.offset-=t.width,L.scroller.style[O]=L.offset+"px",L.active++,L.list.unshift(L.list.pop())),_=null)}function i(){_||(L.active--,L.offset=L.offset+L.list[L.active].width,p(L.list[L.active+1]),_="prev")}function f(){_||(L.offset=L.offset-L.list[L.active].width,L.active++,p(L.list[L.active-1]),_="next")}function m(e){var t=L.list[L.active];t.width+o.zoomDif>t.image.naturalWidth||(L.zoomActive=!0,c(t.image,d.selectors.imageTransition,!0),t.image.style.height=t.image.naturalHeight+"px",A={xRatio:(t.image.naturalWidth-t.width+120*o.zoomOffset)/t.width,yRatio:(t.image.naturalHeight-L.height+120*o.zoomOffset)/L.height,counter:o.zoomAnimDelay,image:t.image},v(e),a(L.controls.zoomer,"mousemove",v,!0))}function u(){function e(){c(t.image,d.selectors.imageTransition),a(t.image,"transitionend webkitTransitionEnd",v),a(t.image,"transitionend webkitTransitionEnd",e)}var t=L.list[L.active];c(t.image,d.selectors.imageTransition,!0),a(t.image,"transitionend webkitTransitionEnd",e,!0),t.image.style.height="",t.image.style.left="",t.image.style.top="",A=null,a(L.controls.zoomer,"mousemove",v),L.zoomActive=!1,x()}function v(e){var t=Date.now();if(A.counter&&t>N+A.counter*o.zoomAnimIncr||!A.counter){var r=L.list[L.active],l=e.offsetX*-A.xRatio+60*o.zoomOffset,s=e.offsetY*-A.yRatio+60*o.zoomOffset;l=Math.max(Math.min(l,0),-r.width*A.xRatio+120*o.zoomOffset),s=Math.max(Math.min(s,0),-L.height*A.yRatio+120*o.zoomOffset),r.image.style.left=l+"px",r.image.style.top=s+"px",A.counter&&(1===A.counter&&c(A.image,d.selectors.imageTransition),A.counter--)}N=t}function p(e){var t=L.list[L.active];c(L.scroller,d.selectors.scrollerTransition,!0),c(e.element,d.selectors.element+d.selectors.active),c(t.element,d.selectors.element+d.selectors.active,!0),L.scroller.style[O]=L.offset+"px",L.controls.block.style.width=t.width+"px"}function g(){h(),L.offset=-L.width+o.offset+(o.reversed?L.list[L.active].width:0),L.controls.block.style[O]=o.offset+"px",L.controls.block.style.width=L.list[L.active].width+"px",L.scroller.style[O]=L.offset+"px",c(L.list[L.active].element,d.selectors.element+d.selectors.active,!0),c(L.scroller,d.selectors.scroller+d.selectors.active,!0),c(L.controls.block,d.selectors.controls+d.selectors.active,!0),L.loaded=!0}function h(){for(var e=0;T>e;e++){var t=L.list[e].image.offsetWidth;L.list[e].element.style.width=L.list[e+T].element.style.width=L.list[e+2*T].element.style.width=t+"px",L.list[e].width=L.list[e+T].width=L.list[e+2*T].width=t,L.width+=t}}function y(){j++,j===T&&g()}function w(){var e=L.wrap.parentNode;e.removeChild(L.wrap),delete e.jolly}function x(){var e=o.zooming;e===k||!e&&L.zoomActive||(c(L.controls.block,d.selectors.controlsZoom,e),a(L.controls.zoomer,"mouseenter",m,e),a(L.controls.zoomer,"mouseleave",u,e),k=e)}function b(e){"undefined"==typeof e&&(e=o.offset),L.offset+=e-o.offset,L.scroller.style[O]=L.offset+"px",L.controls.block.style[O]=e+"px",o.offset=e}function z(e){var t=L.list[L.active].element.offsetLeft;"undefined"!=typeof e&&(L.wrap.style.height=e===!1?null:e+"px"),L.height=L.scroller.offsetHeight,L.width=0,h(),L.controls.block.style.width=L.list[L.active].width+"px",L.offset+=t-L.list[L.active].element.offsetLeft,L.scroller.style[O]=L.offset+"px"}var j=0,_=null,A=null,k=!1,T=t.length,O=o.reflected?"right":"left",N=null,L={loaded:!1,zoomActive:!1,offset:0,height:0,width:0,list:[],controls:{},active:o.reversed?T-1:T};L.wrap=n("div",{"class":d.selectors.wrapper},e),o.height!==!1&&(L.wrap.style.height=o.height+"px"),L.scroller=n("ul",{"class":d.selectors.scroller},L.wrap),L.height=L.scroller.offsetHeight,o.reflected&&c(L.wrap,d.selectors.wrapperReflected,!0),L.controls.block=n("div",{"class":d.selectors.controls},L.wrap),L.controls.prev=n("button",{"class":d.selectors.controlPrev},L.controls.block),L.controls.next=n("button",{"class":d.selectors.controlNext},L.controls.block),L.controls.zoomer=n("div",{"class":d.selectors.controlZoomer},L.controls.block),o.reversed&&t.reverse();for(var E=0;3>E;E++)for(var R in t){var D=t[R],H={width:0};H.element=n("li",{"class":d.selectors.element},L.scroller),H.image=n("img",{"class":d.selectors.image,src:D},H.element),0===E&&a(H.image,"load",y,!0),L.list.push(H)}return a(L.scroller,"transitionend webkitTransitionEnd",r,!0),a(L.controls.prev,"click",o.reversed?f:i,!0),a(L.controls.next,"click",o.reversed?i:f,!0),o.zooming&&x(),{settings:o,tree:L,prev:o.reversed?f:i,next:o.reversed?i:f,destroy:w,updateOffset:b,updateHeight:z,enableZoom:function(){o.zooming=!0,x()},disableZoom:function(){o.zooming=!1,x()}}}function u(e,l,s){var i=[],n=null,c=null,a=null;if(!1 in t||!f())return console.warn("jolly:","Not supported browser!"),!1;"object"==typeof s?a=s:"object"!=typeof l||Array.isArray(l)?"object"!=typeof e||Array.isArray(e)||(a=e):a=l,Array.isArray(l)?c=l:Array.isArray(e)&&(c=e),"string"==typeof e?n=t.querySelectorAll(e):e instanceof HTMLElement?n=[e]:e instanceof NodeList||(n=t.querySelectorAll(d.selectors.targets)),n instanceof NodeList&&(n=Array.prototype.slice.call(n));for(var u in n){var v=n[u];if(!("jolly"in v)){var p=v.getAttribute(d.selectors.targetsData),g=p?JSON.parse(r(p,"'",'"')):null;g=g?g:c;var h=v.getAttribute(d.selectors.targetsSettings),y=h?JSON.parse(r(h,"'",'"')):{};y=o({},d,a,y);var w=new m(v,g,y);v.jolly=Object.keys(w).length?w:!1}i.push(v)}return i}var d={offset:300,height:!1,reflected:!1,reversed:!1,zooming:!0,zoomOffset:5,zoomDif:10,zoomAnimDelay:20,zoomAnimIncr:.3,selectors:{targets:"[data-jolly]",targetsData:"data-jolly",targetsSettings:"data-jolly-settings",wrapper:"jolly",wrapperReflected:"jolly__wrapper--reflected",active:"--active",scroller:"jolly__wrapper",scrollerTransition:"jolly__wrapper--transition",controls:"jolly__controls",controlsZoom:"jolly__controls--zoom",controlPrev:"jolly__control jolly__control--prev",controlNext:"jolly__control jolly__control--next",controlZoomer:"jolly__zoomer",element:"jolly__element",image:"jolly__img",imageTransition:"jolly__img--transition"}};return u});